# 🌱 PlantPal - AI-Powered Plant Health Monitoring Platform

An intelligent plant care companion that uses computer vision and AI to identify plant species, detect diseases, and provide personalized care recommendations.

## 🚀 Features

- 📱 **Plant Disease Detection** - AI-powered analysis using computer vision models
- 🔍 **Species Identification** - Botanical identification through PlantNet API integration
- 🤖 **Smart Care Recommendations** - Personalized advice generated by LLM
- 📊 **Health Tracking** - Monitor plant health scores and trends over time
- 🏆 **Plant Management** - Add, edit, and organize your plant collection
- 📈 **Scan History** - Track health changes with detailed scan records
- 🔒 **Secure Authentication** - AWS Cognito integration for user management
- 📱 **Responsive Design** - Works seamlessly on desktop and mobile devices

## 🛠️ Tech Stack

### Frontend
- **React 18** with **TypeScript**
- **Tailwind CSS** for styling
- **AWS Cognito** for authentication
- **Responsive PWA** design

### Backend
- **FastAPI** (Python) with async/await
- **PostgreSQL** database
- **SQLAlchemy ORM** with Alembic migrations
- **JWT authentication** middleware

### AI/ML Services
- **Hugging Face** - Plant disease detection models
- **PlantNet API** - Botanical species identification
- **OpenRouter + Gemma-3** - LLM for care recommendations

### Cloud Infrastructure
- **AWS ECS** - Containerized backend deployment
- **AWS RDS** - Managed PostgreSQL database
- **AWS S3** - Static website hosting
- **AWS ECR** - Docker image registry
- **GitHub Actions** - CI/CD pipeline

## 🏗️ Architecture

```
┌─────────────────┐    ┌──────────────────┐    ┌─────────────────┐
│   React App     │────│   FastAPI API    │────│   PostgreSQL   │
│   (S3 Static)   │    │   (ECS Docker)   │    │   (RDS)        │
└─────────────────┘    └──────────────────┘    └─────────────────┘
         │                        │
         │                        │
         ▼                        ▼
┌─────────────────┐    ┌──────────────────┐
│  AWS Cognito    │    │   AI Services    │
│  Authentication │    │  • HuggingFace   │
└─────────────────┘    │  • PlantNet      │
                       │  • OpenRouter    │
                       └──────────────────┘
```

## 🚀 Getting Started

### Prerequisites
- Node.js (v18+)
- Python (v3.9+)
- Docker
- AWS Account
- API Keys for HuggingFace, PlantNet, and OpenRouter

### Environment Setup

1. **Clone the repository**
```bash
git clone https://github.com/itmesneha/PlantPal.git
cd PlantPal
```

2. **Backend Setup**
```bash
cd backend
cp .env.example .env
# Configure your environment variables in .env

# Install dependencies
pip install -r requirements.txt

# Run database migrations
python -m alembic upgrade head

# Start the server
python -m app.main
```

3. **Frontend Setup**
```bash
cd frontend
cp .env.example .env.local
# Configure your environment variables

# Install dependencies
npm install

# Start development server
npm start
```

### Environment Variables

#### Backend (.env)
```env
DATABASE_URL=postgresql://user:password@localhost:5432/plantpal
HF_TOKEN=your_huggingface_token
PLANTNET_API_KEY=your_plantnet_key
OPENROUTER_API_KEY=your_openrouter_key
CORS_ORIGINS=http://localhost:3000
```

#### Frontend (.env.local)
```env
REACT_APP_API_URL=http://localhost:8000
REACT_APP_AWS_REGION=your_aws_region
REACT_APP_USER_POOL_ID=your_cognito_user_pool_id
REACT_APP_USER_POOL_CLIENT_ID=your_cognito_client_id
```

## 🐳 Docker Deployment

### Build and Run with Docker
```bash
# Backend
cd backend
docker build -t plantpal-backend .
docker run -p 8000:8000 --env-file .env plantpal-backend

# Frontend (for production build)
cd frontend
npm run build
# Deploy build/ folder to S3 or static hosting service
```

## 📱 API Documentation

Once the backend is running, visit:
- **Interactive API Docs**: http://localhost:8000/docs
- **OpenAPI Spec**: http://localhost:8000/openapi.json

### Key Endpoints
- `POST /api/v1/scan` - Scan plant for disease detection
- `GET /api/v1/plants` - Get user's plant collection
- `PUT /api/v1/plants/{id}` - Update plant information
- `GET /api/v1/scan/history/{plant_id}` - Get scan history

## 🏗️ Database Schema

```sql
Users
├── id (UUID, Primary Key)
├── cognito_user_id (String, Unique)
├── email (String)
└── name (String)

Plants
├── id (UUID, Primary Key)
├── user_id (Foreign Key)
├── name (String)
├── species (String)
├── current_health_score (Float)
├── plant_icon (String)
└── timestamps

PlantScans
├── id (UUID, Primary Key)
├── user_id (Foreign Key)
├── plant_id (Foreign Key, Nullable)
├── health_score (Float)
├── disease_detected (String, Nullable)
├── care_notes (Text, Nullable)
├── is_healthy (Boolean)
└── scan_date (DateTime)
```

## 🚀 Deployment

### AWS Deployment (Production)

1. **Backend**: Deployed automatically via GitHub Actions to ECS
2. **Frontend**: Build and deploy to S3 static hosting
3. **Database**: Managed PostgreSQL on RDS

The CI/CD pipeline automatically:
- Builds Docker images
- Pushes to ECR
- Updates ECS services
- Runs database migrations

## 🔧 Development

### Project Structure
```
PlantPal/
├── backend/
│   ├── app/
│   │   ├── routers/      # API endpoints
│   │   ├── models.py     # Database models
│   │   ├── schemas.py    # Pydantic schemas
│   │   └── main.py       # FastAPI application
│   ├── alembic/          # Database migrations
│   └── Dockerfile
├── frontend/
│   ├── src/
│   │   ├── components/   # React components
│   │   ├── services/     # API services
│   │   └── assets/       # Static assets
│   └── package.json
└── .github/workflows/    # CI/CD pipelines
```

### 🧪 Testing

PlantPal includes comprehensive test suites for both backend and frontend components.

#### Backend Tests (Python/FastAPI)

The backend uses **pytest** with coverage reporting and supports multiple test categories.

```bash
# Navigate to backend directory
cd backend

# Install test dependencies (if not already installed)
pip install -r requirements.txt

# Run all tests
python -m pytest

# Run tests with verbose output
python -m pytest -v

# Run tests with coverage report
python -m pytest --cov=app --cov-report=term-missing

# Generate HTML coverage report
python -m pytest --cov=app --cov-report=html
# View report: open htmlcov/index.html
```

**Test Categories:**
```bash
# Run specific test categories
python -m pytest -m unit          # Unit tests only
python -m pytest -m integration   # Integration tests only
python -m pytest -m api          # API endpoint tests only

# Run specific test files
python -m pytest tests/unit/test_models.py     # Database model tests
python -m pytest tests/unit/test_schemas.py    # Schema validation tests
```

**Current Backend Test Coverage:**
- ✅ **Models**: 100% coverage (User, Plant, PlantScan, Achievement)
- ✅ **Schemas**: 99% coverage (Pydantic validation)
- ⚠️ **Auth**: 39% coverage (Authentication logic)
- ⚠️ **API Routes**: 8-42% coverage (Needs more integration tests)

#### Frontend Tests (React/TypeScript)

The frontend uses **Jest** and **React Testing Library** for component testing.

```bash
# Navigate to frontend directory
cd frontend

# Run tests (non-watch mode)
npm test -- --watchAll=false

# Run tests in watch mode (for development)
npm test

# Run tests with coverage report
npm test -- --coverage --watchAll=false

# Run tests in CI mode (single run)
CI=true npm test
```

**Current Frontend Test Status:**
- ✅ Basic test framework configured
- ✅ Jest and React Testing Library setup
- ⚠️ Limited component tests (placeholder tests only)
- ❌ No AWS Amplify integration tests yet

#### Quick Test Commands

```bash
# Test everything quickly
cd backend && python -m pytest && cd ../frontend && npm test -- --watchAll=false

# Full test suite with coverage
cd backend && python -m pytest --cov=app --cov-report=html && cd ../frontend && npm test -- --coverage --watchAll=false
```

#### Test Configuration Files

- **Backend**: `backend/pytest.ini` - Pytest configuration with coverage settings
- **Frontend**: `frontend/package.json` - Jest configuration via react-scripts

## 🤝 Contributing

1. Fork the repository
2. Create a feature branch (`git checkout -b feature/amazing-feature`)
3. Commit your changes (`git commit -m 'Add amazing feature'`)
4. Push to the branch (`git push origin feature/amazing-feature`)
5. Open a Pull Request

## 📄 License

This project is licensed under the MIT License - see the [LICENSE](LICENSE) file for details.

## 🙏 Acknowledgments

- **Hugging Face** for providing plant disease detection models
- **PlantNet** for botanical species identification API
- **OpenRouter** for LLM integration
- **AWS** for cloud infrastructure services

## 📞 Contact

**Sneha** - [GitHub](https://github.com/itmesneha)

Project Link: [https://github.com/itmesneha/PlantPal](https://github.com/itmesneha/PlantPal)

---

<div align="center">
Made with 💚 for plant lovers everywhere
</div>
